/*
	jQuery Carousel Plugin
	Copyright (c) 2011 Daniel Thomson
	
	Licensed under the MIT license:
	http://www.opensource.org/licenses/mit-license.php
*/

(function(c){c.fn.carousel=function(a){var b=c.extend(!0,{},{itemWidth:50,itemHeight:80,scrollNext:".next",scrollPrev:".prev",scrollPane:!1,scrollSpeed:"1000",scrollNum:5,scrollVisible:3,circular:!1,vertical:!1,startPoint:0,rotating:!1,rotatingSpeed:2E3,rotatingDirection:"forward",rotatingPause:5E3,controlList:".controller"},a);this.each(function(){var a=c(this);a.counter=1;a.scrollPane=b.scrollPane?c(b.scrollPane):a.children("div");a.theList=a.scrollPane.children("ul");a.carouselSize=a.theList.children("li").size(); a.controlList=c(b.controlList);b.circular===!0&&c.fn.carousel.addTail(a,b);a.listItems=a.theList.children("li");a.itemWidth=b.itemWidth;a.itemHeight=b.itemHeight;a.scrollNum=b.scrollNum;a.carouselWidth=a.carouselSize*a.itemWidth;a.carouselHeight=a.carouselSize*a.itemHeight;a.itemDimension=b.vertical===!0?a.itemHeight:a.itemWidth;a.scrollLength=a.scrollNum*a.itemDimension;a.scrollNext=c(b.scrollNext);a.scrollPrev=c(b.scrollPrev);a.scrollVisible=b.scrollVisible;a.scrollPos=0;c.fn.carousel.styleList(a, b);c.fn.carousel.setStartPos(a,b);if(b.rotating===!0&&b.circular===!0)a.rotateTimer=0,c.fn.carousel.rotation(a,b);c.fn.carousel.controlListState(a,b);c(b.scrollNext).click(function(){c.fn.carousel.findScrollPos(a,b,"next");b.circular===!1?c.fn.carousel.findEndPos(a,b,"next"):c.fn.carousel.findEndPosCircular(a,b,"next");c.fn.carousel.controlListState(a,b);c.fn.carousel.animateList(a,b);a.animationEnd=a.scrollPos;if(b.rotating===!0)clearTimeout(a.rotateTimer),a.rotateTimer=setTimeout(function(){c.fn.carousel.rotation(a, b)},b.rotatingPause);return!1});c(b.scrollPrev).click(function(){c.fn.carousel.findScrollPos(a,b,"prev");b.circular===!1?c.fn.carousel.findEndPos(a,b,"prev"):c.fn.carousel.findEndPosCircular(a,b,"prev");c.fn.carousel.controlListState(a,b);c.fn.carousel.animateList(a,b);a.animationEnd=a.scrollPos;if(b.rotating===!0)clearTimeout(a.rotateTimer),a.rotateTimer=setTimeout(function(){c.fn.carousel.rotation(a,b)},b.rotatingPause);return!1});a.controlList.children().click(function(){var f=c(this).parent().children().index(c(this))+ 1,e=a.counter;a.counter=f;c.fn.carousel.controlListState(a,b);c.fn.carousel.setControlMovement(a,b,f,e);c.fn.carousel.animateList(a,b);a.animationEnd=a.scrollPos;if(b.rotating===!0)clearTimeout(a.rotateTimer),a.rotateTimer=setTimeout(function(){c.fn.carousel.rotation(a,b)},b.rotatingPause)})});return this};c.fn.carousel.setStartPos=function(a,b){var d;if(b.startPoint!==0){Math.abs(b.startPoint)>a.carouselSize&&b.circular===!0?b.startPoint>0?(d=Math.floor(b.startPoint/a.carouselSize),d=b.startPoint- a.carouselSize*d):(d=Math.ceil(b.startPoint/a.carouselSize),d=b.startPoint-a.carouselSize*d+a.carouselSize):d=(b.startPoint>a.carouselSize||b.startPoint<0)&&b.circular===!1?1:b.startPoint>0?b.startPoint:b.startPoint+a.carouselSize;a.counter=d;if(b.circular===!0)d=(a.counter+a.scrollVisible)*a.itemDimension-a.itemDimension;else{if(a.counter>a.carouselSize-a.scrollVisible)a.counter=a.carouselSize-a.scrollVisible+1,c(b.scrollNext).addClass("disabled");a.counter>1&&c(b.scrollPrev).removeClass("disabled"); d=a.counter*a.itemDimension-a.itemDimension}b.vertical===!0?a.theList.css("top",-d+"px"):a.theList.css("left",-d+"px");a.scrollPos=-d;a.animationEnd=a.scrollPos}};c.fn.carousel.findEndPos=function(a,b,d){d=="next"?(b.scrollVisible+a.counter+a.scrollNum>a.carouselSize?(b.vertical===!1&&a.theList.css("left",a.animationEnd),a.scrollPos=b.scrollVisible*a.itemDimension-a.carouselSize*a.itemDimension,c(b.scrollNext).addClass("disabled"),a.counter=a.carouselSize-b.scrollVisible+1):a.counter+=a.scrollNum, c(b.scrollPrev).removeClass("disabled")):(a.counter<=a.scrollNum?(a.scrollPos=0,a.counter=1):a.counter-=a.scrollNum,c(b.scrollNext).removeClass("disabled"),a.counter==1&&c(b.scrollPrev).addClass("disabled"))};c.fn.carousel.findEndPosCircular=function(a,b,c){if(c=="next"){if(a.counter+a.scrollNum>a.carouselSize)a.counter-=a.carouselSize,c=a.scrollPos+(a.carouselSize+a.scrollNum)*a.itemDimension,a.scrollPos=c-a.scrollLength,b.vertical===!1?a.theList.css("left",c):a.theList.css("top",c);a.counter+=a.scrollNum}else{if(a.counter< 1)a.counter+=a.carouselSize,c=a.scrollPos-(a.carouselSize+a.scrollNum)*a.itemDimension,a.scrollPos=c+a.scrollLength,b.vertical===!1?a.theList.css("left",c):a.theList.css("top",c);a.counter-=a.scrollNum}};c.fn.carousel.findScrollPos=function(a,b,c){b.vertical===!1?(a.theList.stop(),a.theList.css("left",a.animationEnd),b=parseInt(a.theList.css("left"),10)):(a.theList.stop(),a.theList.css("top",a.animationEnd),b=parseInt(a.theList.css("top"),10));a.scrollPos=c=="next"?b-a.scrollLength:b+a.scrollLength}; c.fn.carousel.animateList=function(a,b){b.vertical===!1?a.theList.animate({left:a.scrollPos},b.scrollSpeed):a.theList.animate({top:a.scrollPos},b.scrollSpeed)};c.fn.carousel.setControlMovement=function(a,b,d,f){var e;e=b.vertical===!0?b.itemHeight:b.itemWidth;b.circular===!1&&(d>1&&c(b.scrollPrev).removeClass("disabled"),d<=1&&c(b.scrollPrev).addClass("disabled"),d<=a.carouselSize-a.scrollVisible&&c(b.scrollNext).removeClass("disabled"),d>a.carouselSize-a.scrollVisible&&c(b.scrollNext).addClass("disabled")); if(d>a.carouselSize-(a.scrollVisible-1)&&b.circular===!1)d=a.carouselSize-(a.scrollVisible-1),a.counter=a.carouselSize-(a.scrollVisible-1),a.controlList.children(":gt("+(d-2)+")").addClass("active");a.scrollPos-=(d-f)*e};c.fn.carousel.rotation=function(a,b){a.rotateTimer=setTimeout(function(){c.fn.carousel.rotation(a,b)},b.rotatingSpeed+b.rotatingPause);if(b.rotatingDirection==="forward")c.fn.carousel.findScrollPos(a,b,"next"),c.fn.carousel.findEndPosCircular(a,b,"next"),a.animationEnd=a.scrollPos, b.vertical===!1?a.theList.animate({left:a.scrollPos},b.rotatingSpeed):a.theList.animate({top:a.scrollPos},b.rotatingSpeed);else if(b.rotatingDirection==="backward")c.fn.carousel.findScrollPos(a,b,"prev"),c.fn.carousel.findEndPosCircular(a,b,"prev"),a.animationEnd=a.scrollPos,b.vertical===!1?a.theList.animate({left:a.scrollPos},b.rotatingSpeed):a.theList.animate({top:a.scrollPos},b.rotatingSpeed);c.fn.carousel.controlListState(a,b)};c.fn.carousel.addTail=function(a,b){for(var c=0;c<b.scrollVisible;c++){var f= "li:eq("+(a.carouselSize-1)+")",e=a.theList.children("li:eq("+c*2+")").clone(),f=a.theList.children(f).clone();e.appendTo(a.theList);f.prependTo(a.theList)}};c.fn.carousel.controlListState=function(a,b){var c=b.scrollVisible;controlItems=a.controlList.children();controlItems.removeClass("active");for(var f=0;f<c;f++){var e=a.counter+f-1;e>=controlItems.length&&b.circular===!0&&(e-=controlItems.length);e<0&&(e=a.carouselSize+e);a.controlList.children(":eq("+e+")").addClass("active")}};c.fn.carousel.styleList= function(a,b){a.css({position:"relative"});a.scrollPane.css({position:"relative",left:"0px",overflow:"hidden","z-index":"2"});a.theList.css({"list-style-type":"none",margin:"0px",padding:"0px",position:"relative","z-index":"1",height:a.carouselHeight+"px",width:a.itemWidth+"px",left:"0px",top:"0px"});a.listItems.css({"float":"left",overflow:"hidden",display:"block",height:a.itemHeight+"px",width:a.itemWidth+"px"});b.vertical===!0?(a.scrollPane.css({height:a.itemHeight*a.scrollVisible+"px",width:a.itemWidth+ "px"}),a.theList.css({height:a.carouselHeight+"px",width:a.itemWidth+"px"}),b.circular===!0&&a.theList.css({top:0-a.scrollVisible*a.itemHeight+"px",height:a.carouselHeight+a.scrollVisible*a.itemHeight*2+"px"}),a.animationEnd=a.theList.css("top")):(a.scrollPane.css({height:a.itemHeight,width:a.itemWidth*a.scrollVisible+"px"}),a.theList.css({height:a.itemHeight+"px",width:a.carouselWidth+"px"}),b.circular===!0&&a.theList.css({left:0-a.scrollVisible*a.itemWidth+"px",width:a.carouselWidth+a.scrollVisible* a.itemWidth*2+"px"}),a.animationEnd=a.theList.css("left"));b.circular===!1&&c(a.scrollPrev).addClass("disabled")}})(jQuery);