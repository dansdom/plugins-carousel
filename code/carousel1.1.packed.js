/*
	jQuery Carousel Plugin
	Copyright (c) 2011 Daniel Thomson
	
	Licensed under the MIT license:
	http://www.opensource.org/licenses/mit-license.php
*/

(function(d){d.fn.carousel=function(a){var c={itemWidth:50,itemHeight:80,scrollNext:".next",scrollPrev:".prev",scrollSpeed:"1000",scrollNum:5,scrollVisible:3,circular:false,vertical:false};c&&d.extend(c,a);this.each(function(){var b=d(this);b.counter=1;b.scrollPane=b.children("div");b.theList=b.children("div").children("ul");b.carouselSize=b.theList.children("li").size();c.circular==true&&d.fn.carousel.addTail(b,c);b.listItems=b.children("div").children("ul").children("li");b.itemWidth=c.itemWidth; b.itemHeight=c.itemHeight;b.scrollNum=c.scrollNum;b.carouselWidth=b.carouselSize*b.itemWidth;b.carouselHeight=b.carouselSize*b.itemHeight;b.itemDimension=c.vertical==true?b.itemHeight:b.itemWidth;b.scrollLength=b.scrollNum*b.itemDimension;b.scrollNext=d(c.scrollNext);b.scrollPrev=d(c.scrollPrev);b.scrollVisible=c.scrollVisible;b.scrollPos=0;d.fn.carousel.styleList(b,c);d(c.scrollNext).click(function(){d.fn.carousel.findScrollPos(b,c,"next");c.circular==false?d.fn.carousel.findEndPos(b,c,"next"):d.fn.carousel.findEndPosCircular(b, c,"next");d.fn.carousel.animateList(b,c);b.animationEnd=b.scrollPos;return false});d(c.scrollPrev).click(function(){d.fn.carousel.findScrollPos(b,c,"prev");c.circular==false?d.fn.carousel.findEndPos(b,c,"prev"):d.fn.carousel.findEndPosCircular(b,c,"prev");d.fn.carousel.animateList(b,c);b.animationEnd=b.scrollPos;return false})});return this};d.fn.carousel.findEndPos=function(a,c,b){if(b=="next"){if(c.scrollVisible+a.counter+a.scrollNum>a.carouselSize){c.vertical==false&&a.theList.css("left",a.animationEnd); a.scrollPos=c.scrollVisible*a.itemDimension-a.carouselSize*a.itemDimension;d(c.scrollNext).addClass("disabled");a.counter=a.carouselSize-c.scrollVisible+1}else a.counter+=a.scrollNum;d(c.scrollPrev).removeClass("disabled")}else{if(a.counter<=a.scrollNum){a.scrollPos=0;a.counter=1}else a.counter-=a.scrollNum;d(c.scrollNext).removeClass("disabled");a.counter==1&&d(c.scrollPrev).addClass("disabled")}};d.fn.carousel.findEndPosCircular=function(a,c,b){if(b=="next"){if(a.counter+a.scrollNum>a.carouselSize){a.counter-= a.carouselSize;b=a.scrollPos+(a.carouselSize+a.scrollNum)*a.itemDimension;a.scrollPos=b-a.scrollLength;c.vertical==false?a.theList.css("left",b):a.theList.css("top",b)}a.counter+=a.scrollNum}else{if(a.counter<1){a.counter+=a.carouselSize;b=a.scrollPos-(a.carouselSize+a.scrollNum)*a.itemDimension;a.scrollPos=b+a.scrollLength;c.vertical==false?a.theList.css("left",b):a.theList.css("top",b)}a.counter-=a.scrollNum}};d.fn.carousel.findScrollPos=function(a,c,b){if(c.vertical==false){a.theList.stop();a.theList.css("left", a.animationEnd);c=parseInt(a.theList.css("left"));a.scrollPos=b=="next"?c-a.scrollLength:c+a.scrollLength}else{a.theList.stop();a.theList.css("top",a.animationEnd);c=parseInt(a.theList.css("top"));a.scrollPos=b=="next"?c-a.scrollLength:c+a.scrollLength}};d.fn.carousel.animateList=function(a,c){c.vertical==false?a.theList.animate({left:a.scrollPos},c.scrollSpeed):a.theList.animate({top:a.scrollPos},c.scrollSpeed)};d.fn.carousel.addTail=function(a,c){for(i=0;i<c.scrollVisible;i++){lastIndex="li:eq("+ (a.carouselSize-1)+")";firstIndex="li:eq("+i*2+")";appendage=a.theList.children(firstIndex).clone();prependage=a.theList.children(lastIndex).clone();appendage.appendTo(a.theList);prependage.prependTo(a.theList)}};d.fn.carousel.styleList=function(a,c){a.css({position:"relative"});a.scrollPane.css({position:"relative",left:"0px",overflow:"hidden","z-index":"2"});a.theList.css({"list-style-type":"none",margin:"0px",padding:"0px",position:"relative","z-index":"1",height:a.carouselHeight+"px",width:a.itemWidth+ "px",left:"0px",top:"0px"});a.listItems.css({cssFloat:"left",overflow:"hidden",display:"block",height:a.itemHeight+"px",width:a.itemWidth+"px"});carouselWidth=a.listItems*a.scrollVisible;if(c.vertical==true){a.scrollPane.css({height:a.itemHeight*a.scrollVisible+"px",width:a.itemWidth+"px"});a.theList.css({height:a.carouselHeight+"px",width:a.itemWidth+"px"});c.circular==true&&a.theList.css({top:0-a.scrollVisible*a.itemHeight+"px",height:a.carouselHeight+a.scrollVisible*a.itemHeight*2+"px"});a.animationEnd= a.theList.css("top")}else{a.scrollPane.css({height:a.itemHeight,width:a.itemWidth*a.scrollVisible+"px"});a.theList.css({height:a.itemHeight+"px",width:a.carouselWidth+"px"});c.circular==true&&a.theList.css({left:0-a.scrollVisible*a.itemWidth+"px",width:a.carouselWidth+a.scrollVisible*a.itemWidth*2+"px"});a.animationEnd=a.theList.css("left")}c.circular==false&&d(a.scrollPrev).addClass("disabled")}})(jQuery);